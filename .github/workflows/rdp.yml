# Create ultra-privileged admin user with enhanced error handling
        Write-Host "Creating admin user account..."
        
        # Remove existing user if present
        try {
            $existingUser = Get-LocalUser "rdpadmin" -ErrorAction SilentlyContinue
            if ($existingUser) {
                Write-Host "Removing existing rdpadmin user..."
                Remove-LocalUser "rdpadmin" -ErrorAction Stop
                Write-Host "✅ Existing user removed successfully"
            }
        } catch {
            Write-Host "⚠️ Warning: Could not remove existing user: $($_.Exception.Message)"
        }
        
        # Use a simple password that meets Windows requirements
        $password = "Password123!"
        
        try {
            Write-Host "Creating user with PowerShell..."
            $securePassword = ConvertTo-SecureString $password -AsPlainText -Force
            
            New-LocalUser -Name "rdpadmin" `
                         -Password $securePassword `
                         -FullName "Ultra Performance Admin" `
                         -Description "Maximum CPU Performance Administrator" `
                         -PasswordNeverExpires `
                         -UserMayNotChangePassword `
                         -ErrorAction Stop
            
            Write-Host "✅ User 'rdpadmin' created successfully"
            
        } catch {
            Write-Host "PowerShell method failed, trying net user command..."
            
            $result = cmd /c "net user rdpadmin $password /add /fullname:`"Ultra Performance Admin`" /comment:`"Maximum CPU Performance Administrator`" /passwordchg:no /expires:never /active:yes 2>&1"
            Write-Host "Net user result: $result"
            
            # Verify user was created
            $verifyUser = cmd /c "net user rdpadmin 2>&1"
            if ($verifyUser -match "User name" -and $verifyUser -notmatch "could not be found") {
                Write-Host "✅ User created with net user command"
            } else {
                Write-Host "❌ User creation failed completely"
                throw "User creation failed"
            }
        }
        
        # Add to groups
        Write-Host "Adding user to administrative groups..."
        try {
            Add-LocalGroupMember -Group "Administrators" -Member "rdpadmin" -ErrorAction Stop
            Add-LocalGroupMember -Group "Remote Desktop Users" -Member "rdpadmin" -ErrorAction Stop
            Write-Host "✅ Added to groups successfully"
        } catch {
            # Fallback to net command
            cmd /c "net localgroup administrators rdpadmin /add 2>&1"
            cmd /c "net localgroup `"Remote Desktop Users`" rdpadmin /add 2>&1"
            Write-Host "✅ Added to groups using net command"
        }